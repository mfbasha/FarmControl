(function(){function getParameterByName(name,url){url||(url=window.location.href);name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null}function showMessage(seconds){document.getElementById("redirectInfo").innerHTML=document.getElementById("redirectInfo").innerHTML.replace(/\d+/,seconds)}function showError(error){document.getElementById("redirectInfo").innerHTML=error}function parseUrl(url){var r={},a=document.createElement("a");return a.href=url,["protocol","hostname","port","pathname","search","hash"].map(function(n){r[n]=a[n]}),r}function strEndsWith(str,suffix){return str.match(suffix+"$")==suffix}function isValidUrl(url,hostWhiteList){for(var urlParts=parseUrl(url),i=0;i<hostWhiteList.length;i++)if(urlParts.hostname.toLowerCase()===hostWhiteList[i]||strEndsWith(urlParts.hostname.toLowerCase(),"."+hostWhiteList[i]))return!0;return!1}window.onload=function(){var hostWhiteList,redirectUrl,remainingSeconds;document.getElementById("redirectInfo")!==null&&(hostWhiteList=["microsoft.com","visualstudio.com","github.com"],redirectUrl=getParameterByName("redirectUrl",window.location.href),redirectUrl&&redirectUrl.length>0&&(isValidUrl(redirectUrl,hostWhiteList)?(document.getElementById("redirectInfo").innerHTML=document.getElementById("jumpInfo").innerHTML,remainingSeconds=1,showMessage(remainingSeconds),setInterval(function(){remainingSeconds>0?(remainingSeconds--,showMessage(remainingSeconds)):remainingSeconds===0&&(remainingSeconds--,window.location.href=redirectUrl)},1e3)):showError("XSS and Open Redirect Vulnerability Error!")))}})();;
(function(){var TechnetHeaderModule=function($){window.technet=window.technet||{};window.technet.header=window.technet.header||{};window.technet.header.closeAll=function(){closeAll()};window.technet.header.deviceTypes=function(){return deviceTypes};window.technet.header.currentDeviceType=function(){return currentDeviceType};var deviceTypes={desktop:"desktop",tablet:"tablet",mobile:"mobile"},windowWidth=0,isTocElementsMoved=!1,isSearchElementsMoved=!1,currentDeviceType=deviceTypes.desktop,$toggles=$("#ux-header div#gripAndBrandLogo div#grip-menu"),$drawer=$("#ux-header .upperBand .row2 #drawer"),$searchToggle=$("#ux-header .upperBand .row2 #search-menu"),$searchPanel=$("#ux-header .upperBand .row3"),$settingToggle=$("#ux-header div.row1 .controls #setting-menu"),$settringPanel=$("#ux-header div.row1 .controls .controlsInternal"),tocElementsShouldMove=function(){return $("#ux-header div#gripAndBrandLogo div#grip-menu:visible").length>0},searchElementsShouldMove=function(){return $("#ux-header div#search-menu:visible").length>0},moveTocElements=function(restoreOriginalPosition){restoreOriginalPosition?$("#ux-header .upperBand .row2 #drawer > a").appendTo($("#ux-header .lowerBand .toclevel1")):$("#ux-header .lowerBand .toclevel1 > a").appendTo($("#ux-header .upperBand .row2 #drawer"));isTocElementsMoved=!restoreOriginalPosition},moveSearchElements=function(restoreOriginalPosition){restoreOriginalPosition?$("#ux-header .upperBand .row3 .SearchBox").insertAfter($("#ux-header .upperBand .row2 #search-menu")):$("#ux-header .upperBand .row2 .SearchBox").appendTo($("#ux-header .upperBand .row3"));isSearchElementsMoved=!restoreOriginalPosition},toggleMenu=function(){var selfActive=$drawer.css("display")=="block";window.technet.header.magabladeMenu.closeAll();closeAll();selfActive||($drawer.css("display","block"),$toggles.removeClass("inactive").addClass("active"),$(window).bind("resize",closeMenuAndUnBind),$("html, body").bind("click",closeMenuAndUnBind))},toggleSearchMenu=function(){var selfActive=$searchPanel.css("display")=="block";window.technet.header.magabladeMenu.closeAll();closeAll();selfActive?closeSearchBar():($searchPanel.css("display","block"),$searchToggle.removeClass("inactive").addClass("active"))},toggleSettingMenu=function(){var selfActive=$settringPanel.css("display")=="block";window.technet.header.magabladeMenu.closeAll();closeAll();selfActive||($settringPanel.css("display","block"),$settingToggle.removeClass("inactive").addClass("active"),$(window).bind("resize",closeMenuAndUnBind),$("html, body").bind("click",closeMenuAndUnBind))},closeSearchBar=function(){$searchPanel.css("display","none");$searchToggle.removeClass("active").addClass("inactive")},closeAll=function(){$drawer.css("display","none");$toggles.removeClass("active").addClass("inactive");currentDeviceType==deviceTypes.mobile&&($settringPanel.css("display",""),$settingToggle.removeClass("active").addClass("inactive"))},closeMenuAndUnBind=function(){closeAll();$(window).unbind("resize",closeMenuAndUnBind);$("html, body").unbind("click",closeMenuAndUnBind)},resize=function(){isTocElementsMoved!=tocElementsShouldMove()&&moveTocElements(isTocElementsMoved);isSearchElementsMoved!=searchElementsShouldMove()&&(closeSearchBar(),moveSearchElements(isSearchElementsMoved));currentDeviceType=isTocElementsMoved?isSearchElementsMoved?deviceTypes.mobile:deviceTypes.tablet:deviceTypes.desktop;$("#ux-header").attr("data-device-type",currentDeviceType)},init=function(){$toggles.length>0&&$toggles.click(function(e){toggleMenu();e.stopPropagation()});$searchToggle.length>0&&$searchToggle.click(function(e){toggleSearchMenu();e.stopPropagation()});$settingToggle.length>0&&$settingToggle.click(function(e){toggleSettingMenu();e.stopPropagation()});$(window).resize(function(){windowWidth!=$(window).width()&&(resize(),windowWidth=$(window).width())});resize();windowWidth=$(window).width()};$(document).ready(function(){init()})};typeof define=="function"&&window.mtpsAmd?define("TechnetHeader",["jquery"],function($){return TechnetHeaderModule($)}):TechnetHeaderModule($)})();;
